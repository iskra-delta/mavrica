ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 1.
Hexadecimal [24-Bits]



                                      1 		;; sdcc.s
                                      2         ;; 
                                      3         ;; minimal sdcc library
                                      4 		;;
                                      5         ;; MIT License (see: LICENSE)
                                      6         ;; copyright (c) 2022 tomaz stih
                                      7         ;;
                                      8 		;; 31.03.2022    tstih
                                      9         .module sdcc
                                     10 
                                     11         .globl  __divuint
                                     12         .globl  __divuchar
                                     13         .globl  __moduchar
                                     14         .globl  __moduint
                                     15 
                                     16         .area   _CODE
      000000                         17  __divuint::
      000000 F1               [10]   18         pop     af
      000001 E1               [10]   19         pop     hl
      000002 D1               [10]   20         pop     de
      000003 D5               [11]   21         push    de
      000004 E5               [11]   22         push    hl
      000005 F5               [11]   23         push    af
      000006 18 0A            [12]   24         jr      __divu16
      000008                         25 __divuchar::
      000008 21 03 00         [10]   26         ld      hl,#2+1
      00000B 39               [11]   27         add     hl,sp
      00000C 5E               [ 7]   28         ld      e,(hl)
      00000D 2B               [ 6]   29         dec     hl
      00000E 6E               [ 7]   30         ld      l,(hl)
      00000F                         31 __divu8:
      00000F 26 00            [ 7]   32         ld      h,#0x00
      000011 54               [ 4]   33         ld      d,h
                                     34       
      000012                         35 __divu16:
      000012 7B               [ 4]   36         ld      a,e
      000013 E6 80            [ 7]   37         and     a,#0x80
      000015 B2               [ 4]   38         or      a,d
      000016 20 10            [12]   39         jr      NZ,.morethan7bits
      000018                         40 .atmost7bits:
      000018 06 10            [ 7]   41         ld      b,#16          
      00001A ED 6A            [15]   42         adc     hl,hl
      00001C                         43 .dvloop7:
      00001C 17               [ 4]   44         rla
      00001D 93               [ 4]   45         sub     a,e
      00001E 30 01            [12]   46         jr      NC,.nodrop7   
      000020 83               [ 4]   47         add     a,e            
      000021                         48 .nodrop7:
      000021 3F               [ 4]   49         ccf                               
      000022 ED 6A            [15]   50         adc     hl,hl
      000024 10 F6            [13]   51         djnz    .dvloop7
      000026 5F               [ 4]   52         ld      e,a             
      000027 C9               [10]   53         ret
      000028                         54 .morethan7bits:
      000028 06 09            [ 7]   55         ld      b,#9           
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 2.
Hexadecimal [24-Bits]



      00002A 7D               [ 4]   56         ld      a,l             
      00002B 6C               [ 4]   57         ld      l,h           
      00002C 26 00            [ 7]   58         ld      h,#0
      00002E CB 1D            [ 8]   59         rr      l              
      000030                         60 .dvloop:
      000030 ED 6A            [15]   61         adc     hl,hl           
      000032 ED 52            [15]   62         sbc     hl,de
      000034 30 01            [12]   63         jr      NC,.nodrop      
      000036 19               [11]   64         add     hl,de           
      000037                         65 .nodrop:
      000037 3F               [ 4]   66         ccf                    
      000038 17               [ 4]   67         rla
      000039 10 F5            [13]   68         djnz    .dvloop
      00003B CB 10            [ 8]   69         rl      b               
      00003D 50               [ 4]   70         ld      d,b
      00003E 5F               [ 4]   71         ld      e,a           
      00003F EB               [ 4]   72         ex      de,hl           
      000040 C9               [10]   73         ret
      000041                         74 __moduchar::
      000041 21 03 00         [10]   75         ld      hl,#2+1
      000044 39               [11]   76         add     hl,sp
      000045 5E               [ 7]   77         ld      e,(hl)
      000046 2B               [ 6]   78         dec     hl
      000047 6E               [ 7]   79         ld      l,(hl)
      000048 CD 0F 00         [17]   80         call    __divu8
      00004B EB               [ 4]   81 	    ex	de,hl
      00004C C9               [10]   82         ret
      00004D                         83 __moduint::
      00004D F1               [10]   84         pop     af
      00004E E1               [10]   85         pop     hl
      00004F D1               [10]   86         pop     de
      000050 D5               [11]   87         push    de
      000051 E5               [11]   88         push    hl
      000052 F5               [11]   89         push    af
      000053 CD 12 00         [17]   90         call    __divu16
      000056 EB               [ 4]   91         ex      de,hl
      000057 C9               [10]   92         ret    
